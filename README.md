# å“ˆå·¥å¤§ï¼ˆæ·±åœ³ï¼‰æ•™åŠ¡ç³»ç»Ÿ MCP æœåŠ¡

åŸºäºç¼“å­˜ä¼˜åŒ–çš„å“ˆå·¥å¤§ï¼ˆæ·±åœ³ï¼‰æ•™åŠ¡ç³»ç»ŸAPIæœåŠ¡ï¼Œæ”¯æŒè‡ªåŠ¨ç™»å½•å’Œæ™ºèƒ½æ•°æ®ç¼“å­˜ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **æ™ºèƒ½ç¼“å­˜æœºåˆ¶**: é¿å…é‡å¤è¯·æ±‚ï¼Œæå‡æ€§èƒ½
- ğŸ” **è‡ªåŠ¨ç™»å½•**: ä» `.env` æ–‡ä»¶è¯»å–å‡­æ®ï¼Œæ— éœ€æ‰‹åŠ¨ç™»å½•
- ğŸ“Š **å®Œæ•´æ•°æ®**: è·å–æˆç»©ã€GPAã€æ’åç­‰å®Œæ•´ä¿¡æ¯
- ğŸ“ **æ•°æ®å¯¼å‡º**: æ”¯æŒå¯¼å‡ºæˆç»©ä¸º CSV æ ¼å¼
- ğŸ”§ **MCP å…¼å®¹**: å®Œå…¨å…¼å®¹ Model Context Protocol

## å®‰è£…ä¾èµ–

```bash
pip install python-dotenv mcp requests beautifulsoup4
```

## é…ç½®è®¾ç½®

### 1. åˆ›å»º `.env` æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```env
# å“ˆå·¥å¤§ï¼ˆæ·±åœ³ï¼‰æ•™åŠ¡ç³»ç»Ÿç™»å½•å‡­æ®
HITSZ_USERNAME=your_student_id
HITSZ_PASSWORD=your_password
```

**æ³¨æ„**: 
- è¯·å°† `your_student_id` æ›¿æ¢ä¸ºä½ çš„å­¦å·
- è¯·å°† `your_password` æ›¿æ¢ä¸ºä½ çš„å¯†ç 
- `.env` æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¯·å‹¿æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ

### 2. ç¯å¢ƒå˜é‡æ–¹å¼ï¼ˆå¯é€‰ï¼‰

å¦‚æœä¸ä½¿ç”¨ `.env` æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export HITSZ_USERNAME=your_student_id
export HITSZ_PASSWORD=your_password
```

## ä½¿ç”¨æ–¹æ³•

### ä½œä¸º MCP æœåŠ¡è¿è¡Œ

```bash
python mcp_jw_service.py
```

### å¯ç”¨å·¥å…·

| å·¥å…·åç§° | æè¿° | ç¼“å­˜çŠ¶æ€ |
|---------|------|---------|
| `get_all_grades` | åŠ è½½æ‰€æœ‰æ•°æ®å¹¶è¿”å›æ‘˜è¦ä¿¡æ¯ | åŸºç¡€æ•°æ®æº |
| `get_gpa_info` | è·å–GPAå’Œæ’åä¿¡æ¯ | åŸºäºç¼“å­˜ |
| `get_semester_list` | è·å–å­¦æœŸåˆ—è¡¨ | åŸºäºç¼“å­˜ |
| `get_grades_by_semester` | è·å–æŒ‡å®šå­¦æœŸæˆç»© | åŸºäºç¼“å­˜ |
| `export_grades_to_csv` | å¯¼å‡ºæˆç»©ä¸ºCSV | åŸºäºç¼“å­˜ |
| `get_server_info` | è·å–æœåŠ¡å™¨ä¿¡æ¯ | - |

### ç¼“å­˜æœºåˆ¶è¯´æ˜

1. **é¦–æ¬¡è°ƒç”¨**: `get_all_grades` ä¼šä»æ•™åŠ¡ç³»ç»Ÿè·å–æ•°æ®å¹¶ç¼“å­˜ï¼Œè¿”å›æ•°æ®æ‘˜è¦
2. **åç»­è°ƒç”¨**: å…¶ä»–å·¥å…·éƒ½åŸºäºç¼“å­˜æ•°æ®å·¥ä½œï¼Œæ— éœ€é‡å¤è¯·æ±‚
3. **æ•°æ®åˆ·æ–°**: é‡å¯æœåŠ¡å¯åˆ·æ–°ç¼“å­˜
4. **ä¸Šä¸‹æ–‡ä¼˜åŒ–**: `get_all_grades` åªè¿”å›æ‘˜è¦ä¿¡æ¯ï¼Œé¿å…ä¸Šä¸‹æ–‡è¿‡é•¿

## æ•°æ®ç»“æ„

### æˆç»©ä¿¡æ¯ (CourseGrade)

```json
{
  "course_id": "è¯¾ç¨‹ä»£ç ",
  "course_name": "è¯¾ç¨‹åç§°", 
  "course_name_en": "è¯¾ç¨‹è‹±æ–‡åç§°",
  "credit": 3.0,
  "semester": "2023-20241",
  "semester_display": "2023-2024å­¦å¹´ç¬¬1å­¦æœŸ",
  "score": "85",
  "score_raw": "85",
  "exam_type": "è€ƒè¯•",
  "course_type": "å¿…ä¿®",
  "course_category": "ä¸“ä¸šè¯¾",
  "department": "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢",
  "is_pass": true,
  "is_restudy": false,
  "rank": "15",
  "total_students": "120"
}
```

### GPAä¿¡æ¯ (GPAInfo)

```json
{
  "gpa": 3.85,
  "all_course_gpa": 3.82,
  "avg_score": 87.5,
  "all_course_avg_score": 86.8,
  "rank": 25,
  "total_students": 300,
  "rank_percentage": 8.33,
  "passed_courses": 45,
  "total_credits": 120.5
}
```

## ç¤ºä¾‹å“åº”

### get_all_grades

```json
{
  "success": true,
  "message": "æ•°æ®å·²æˆåŠŸåŠ è½½åˆ°ç¼“å­˜",
  "summary": {
    "total_courses": 45,
    "total_credits": 120.5,
    "passed_courses": 43,
    "failed_courses": 2,
    "restudy_courses": 1,
    "required_courses": 35,
    "elective_courses": 10,
    "semesters_count": 6,
    "semester_summary": [
      {"code": "2023-20241", "name": "2023-2024å­¦å¹´ç¬¬1å­¦æœŸ", "courses": 8},
      {"code": "2022-20232", "name": "2022-2023å­¦å¹´ç¬¬2å­¦æœŸ", "courses": 7}
    ]
  },
  "gpa_summary": {
    "gpa": 3.85,
    "all_course_gpa": 3.82,
    "rank": 25,
    "total_students": 300,
    "rank_percentage": 8.33,
    "avg_score": 87.5
  }
}
```

### get_semester_list

```json
{
  "success": true,
  "semesters": [
    {"code": "2023-20241", "name": "2023-2024å­¦å¹´ç¬¬1å­¦æœŸ"},
    {"code": "2022-20232", "name": "2022-2023å­¦å¹´ç¬¬2å­¦æœŸ"},
    ...
  ]
}
```

## é”™è¯¯å¤„ç†

æœåŠ¡ä¼šè‡ªåŠ¨å¤„ç†ä»¥ä¸‹æƒ…å†µï¼š

1. **å‡­æ®æœªé…ç½®**: æä¾›è¯¦ç»†çš„é…ç½®è¯´æ˜
2. **ç™»å½•å¤±è´¥**: è‡ªåŠ¨é‡è¯•ç™»å½•
3. **ç½‘ç»œé”™è¯¯**: è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
4. **æ•°æ®è§£æé”™è¯¯**: è·³è¿‡æœ‰é—®é¢˜çš„è®°å½•ï¼Œç»§ç»­å¤„ç†å…¶ä»–æ•°æ®

## æ€§èƒ½ä¼˜åŒ–

- âœ… æ™ºèƒ½ç¼“å­˜ï¼šé¿å…é‡å¤ç½‘ç»œè¯·æ±‚
- âœ… æ‰¹é‡è·å–ï¼šä¸€æ¬¡è¯·æ±‚è·å–æ‰€æœ‰æ•°æ®
- âœ… æ‡’åŠ è½½ï¼šåªåœ¨éœ€è¦æ—¶æ‰è·å–æ•°æ®
- âœ… å†…å­˜ç¼“å­˜ï¼šæ•°æ®åœ¨å†…å­˜ä¸­ä¿æŒï¼Œç›´åˆ°æœåŠ¡é‡å¯

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **å‡­æ®ä¿æŠ¤**: `.env` æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¯·å‹¿åˆ†äº«æˆ–æäº¤åˆ°ä»£ç ä»“åº“
2. **ç½‘ç»œå®‰å…¨**: æœåŠ¡é€šè¿‡HTTPSä¸æ•™åŠ¡ç³»ç»Ÿé€šä¿¡
3. **æ•°æ®éšç§**: æ‰€æœ‰æ•°æ®ä»…åœ¨æœ¬åœ°å¤„ç†ï¼Œä¸ä¼šå‘é€åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ImportError: No module named 'dotenv'**
   ```bash
   pip install python-dotenv
   ```

2. **ç™»å½•å¤±è´¥**
   - æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ•™åŠ¡ç³»ç»Ÿå¯ä»¥æ­£å¸¸è®¿é—®

3. **æ•°æ®è·å–å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤æ•™åŠ¡ç³»ç»ŸæœåŠ¡æ­£å¸¸

### è°ƒè¯•æ¨¡å¼

æœåŠ¡ä¼šåœ¨ stderr è¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
- ç™»å½•çŠ¶æ€
- æ•°æ®è·å–è¿›åº¦
- é”™è¯¯è¯¦æƒ…

## ç‰ˆæœ¬å†å²

### v2.0.0
- æ·»åŠ æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- æ”¯æŒ `.env` æ–‡ä»¶è‡ªåŠ¨ç™»å½•
- ç§»é™¤æ‰‹åŠ¨ç™»å½•å·¥å…·
- ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

### v1.0.0
- åŸºç¡€åŠŸèƒ½å®ç°
- æ”¯æŒæ‰‹åŠ¨ç™»å½•
- åŸºæœ¬çš„æˆç»©å’ŒGPAæŸ¥è¯¢

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œä¸ªäººä½¿ç”¨ï¼Œè¯·éµå®ˆå­¦æ ¡ç›¸å…³è§„å®šã€‚
